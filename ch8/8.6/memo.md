# 8.6 書式不定のバイナリ入出力
バイナリ形式で出力したい場合の方法

## 8.6.1 1バイトの入出力
C++ではさまざまな方法で書式を持たないファイル入出力をサポートしていますが、その中で最も低水準なものはget()とput()という2つのメンバー関数です。これらは、1バイトだけ入力/出力することができます。

```C++
// get()メンバー関数とput()メンバー関数
std::istream& get(char& ch);

std::ostream& put(char ch);
```

get()メンバー関数はストリームから1バイト読み込んでchに格納し、使用したストリームを返します。put()メンバー関数はchの値をストリームに1バイトだけ書き込み、使用したストリームを返します。

入力ストリームでは次の1バイトを簡単に取得できると便利なことがあります。これまでに説明したget()メンバー関数では先に格納先の変数が必要となっていたので、今の文字を取得するのが面倒でした。
次のメンバー関数を使用すると、戻り値として取得できるので、ちょっと確認する程後には便利です。


```C++
// get()メンバー関数とpeekメンバー関数
int get();

int peek();
```

どちらのメンバー関数も入力ストリームから1バイトだけ入力しますが、、getメンバー関数は入力したバイトをストリームから取り除き、peekメンバー関数はストリームに残したままになります。1バイト確認して処理を分岐するような場合に、その1バイトを含めてデータとして扱いたいかどうかで使い分けます。

## 8.6.2 ブロックのバイナリ入出力
1バイトだけの入出力で全てを賄うのはとても大変なので、一定の細部をブロックとして一気に入出力する方が一般的です。
ブロックでの入出力にはread()メンバー関数とwrite()メンバー関数を使用します。

```C++
// read()メンバー関数とwrite()メンバー関数
std::istream& read(char* buf, std::streamsize num);

std::ostream& write(const char* buf, std::streamsize num);
```

get()メンバー関数やput()メンバー関数との違いは読み書きするバッファーをポインターで指定する点と、読み書きするサイズを指定しなければならない点です。
write()メンバー関数はバッファーからnumバイトをストリームに書き込み、read()メンバー関数はストリームからnumバイトを読み込んでバッファーに書き込みます。
もし、read()メンバー関数で読み込んでいる最中にファイルの終端に辿り着いてしまった場合は、それまで読み込んだデータだけバッファに書き込んで処理が返ってきます。
実際に読み込んだサイズはgcount()メンバー関数で調べることができます。
```C++
// gcount()メンバー関数
std::streamsize gcount() const;
```

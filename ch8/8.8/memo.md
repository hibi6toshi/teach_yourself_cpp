# 8.8 入出力状態のチェック

入出力のエラーに関する情報を、ストリームオブジェクトでは、std::ios::iostate型という値で保存して、プログラマーが入出力時にエラーがなかったかを確認できます。

| 値 | 意味 |
| --- | --- |
| std::ios::goodbit | エラーが起きなかった |
| std::ios::eofbit | ファイルの終端に到達した |
| std::ios::failbit | 致命的ではないエラーが起きた |
| std::ios::badbit | (復旧できないような)致命的なエラーが起きた |

エラー情報を取得する方法は2通りあり、それはstd::ios::iostateの値を直接取得する方法、その値をもう少し使いやすくboolで取得できるようにしたメンバー関数を使う方法です。

## 8.8.1 現在の情報の取得
直接現在の情報を取得するにはrdstate()メンバー関数を使用します。

```C++
// rdstate()メンバー関数
std::ios::iostate rdstate() const;
```

何もエラーが起きていない場合にはrdstate()メンバー関数はstd::ios::goodbitを返します。それ以外の場合にはエラーフラグを組み合わせた値が返されます。
rdstate()メンバー関数は全ての情報が取れる代わりに、実際にはビット演算をしてどのフラグがセットされているか調べる必要があります。
特定のエラー状態のみを調べたい場合にはそれぞれ専用のメンバー関数を使用するのが楽で良いでしょう。

```C++
// 状態を調べるメンバー関数
bool good() const;

bool eof() const;

bool fail() const;

bool bad() const;
```

good()メンバー関数は何もエラーフラグがセットされていない場合にtrueを返します。
eof()メンバー関数・fail()メンバー関数・bad()メンバー関数はそれぞれのフラグがセットされている場合にtrueを返します。

## 8.8.2 エラーフラグのクリア
エラーフラグは一度セットされると、通常は勝手にリセットされません。フラグをクリアするにはclear()メンバー関数を使用します。

```C++
// clear()メンバー関数
void clear(std::ios::iostate flags = std::ios::goodbit);
```

flagsをデフォルト値のstd::ios::goodbitにすると全てのフラグをクリアできます。
もしフラグを特定の状態にしたい場合には、そのフラグの組み合わせをflagsに渡すことで設定できます。

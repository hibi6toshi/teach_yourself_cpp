# 名前空間

## 4.7.1 名前空間とスコープ解決演算子
関数や変数、クラスなどは自由に名前をつけることができますが、オーバーロードなどの一部を除き、すでにある名前を別のものにつけることはできません。
例えば次のプログラムはエラーになります。

```C++
using awesom_name = int;

class awesome_name // エラー。awesome_name はすでに使われている
{
  ...
}

int awesome_name; // エラー　クラス名とは衝突しないが、int の別名と衝突する

void awesome_name() // エラー　クラス名とは衝突しないが変数名とintの別名と衝突する
{
  ...
}
```

**名前空間**を使うことで、ライブラリAの関数FとライブラリBの関数Fを区別できるようになります。
例えば、標準ライブラリで定義されるものはすべてstd名前空間の中で定義されているので、同じ名前のクラスなどを定義しても衝突しません。

名前空間の構文は次のとおり
```C++
namespace namespace-name {
  namespace-body...
}
```
namespace-body には関数やクラス、変数や型の別名などおよそほとんどのものを記載でき、それらはすべてnamespace-nameで指定した名前変数に属することになります。

## スコープ解決演算子
ある名前空間にある関数やクラスなどを使いたい場合には、**スコープ解決演算子（::）**を使って、所属する名前空間を一緒に指定する必要があります。
グローバル名前空間のものを使うときには特に名前空間を指定する必要はありません。

スコープ解決演算子の構文は次のとおりです。
```C++
namespace-name::type-name variable-name; // 変数宣言

namespace-name::function-name(); // 関数呼び出し

namespace-name::variable-name; // 変数の使用
```

## 4.7.2 ネストした名前空間
名前空間はその中にさらに名前空間を持つことができます。このようなネストした名前空間を使うと、ライブラリの中でさらに機能ごとに分けたり、ユーザーに公開する日つおようのない内部実装用の機能をまとめたりして、必要な機能だけを整理して提供できます。

```C++
namespace library {
  namespace module {
    namespace detail {
      void internal_function();
    }
  }
}

int main() {
  // ネストした名前空間の内側の関数呼び出し
  library::module::detail::internal_function();
}
```

ネストが深くなると上記のように{}が多くなってしまい、管理が煩雑になります。そこで、名前空間の中に名前空間しかない単純な場合に限り、省略した方法でネストした名前空間を定義できます。
```C++
namespace toplevel-namespace-name::nested-namespace-name {
  ...
}

// 何弾もかける
namespace top-level::midle-name::last_level {
  ...
}
```

## 4.7.3 名前空間の省略
ある名前空間に属する何かを使うおsd機には、スコープ解決演算子を使って名前空間を指定しなければなりませんでした。しかし実際には、名前空間を指定しなくても問題ない場合がいくつかあります。

C++における名前探索の手順を確認しておきましょう。
最も基本的な名前検索の手順は、上位の名前空間へと１階層ずつ順番に、再起的に探索していくというものです。具体的には、まず使う側の関数やクラスなどが属する名前空間を着て印として該当する名前があるかを検索し、見つからなければ1つ上位の名前空間を起点として同様に検索していきます。
グローバル名前空間まで検索して見つからなかった場合にはエラーとなります。

## usingディレクティブ
**usingディレクティブ**というものを使うと、コンパイラーに対して特定の名前空間の省略を支持することができ、usingディレクティブが宣言されているスコープでのみ名前空間を省略した呼び出しができるようになります。
```C++
using namespace namespace-name;

using namespace namespace-name::nested_namespace-name;
```

**using宣言**
using宣言は指定した名前のみを今のスコープで使えるようにする宣言です。usingディレクティブが名前空間の省略なので、その名前空間の中にあるものは全て名前空間を省略できましたが、suing宣言ではその名前が属する名前空間の他の名前については省略できません。

```C++
using namespace-name::name;

using namespace-name::nested_namespace-name::name;
```

## namespace の別名
usingディレクティブやusing宣言を使って名前空間を省略する以外にも、別名を与えることで短く描けるようにする方法もあります。

```C++
namespace new-namespace-name = nested-namespace-name;
```

## グローバル名前空間からの絶対パスで指定する
名前空間を省略しているつもりがなくても、usingディレクティブやusing宣言によって別の名前空間にあるものが使われてしまう場合などに、グローバル名前空間からの絶対パスを使って名前を指定する方法があります。スコープ解決演算子で名前空間を指定しなければ、グローバル名前空間から始まる名前として検索が行われます。
```C++
::namespace-name::name // グローバル名前空間を起点に探索
```

## 4.7.4 無名名前空間
名前のない名前空間というものがある。これを**無名名前空間**という。
無名名前空間は、区別するのが**異なるソースファイルに存在する同じ名前**であることが違います。
無名名前空間の構文は通常の名前空間から名前を省略しただけのものになります。

無名名前空間内で宣言された名前は、そのファイル内でのみ有効です。(宣言された変数や関数は他のファイルから見れない)

```C++
namespace {
  ...
}
```

無名名前空間には名前がないため、無名名前空間の中で定義したものを使うときには名前空間の指定は不要です。

# 5.9 関数ポインターと関数リファレンス

## 5.9.1 関数へのポインター
関数はコンピューターへの命令を集めたものですが、その命令自体もメモリ上のどこかに置かれます。つまり関数もまた変数と同じようにアドレスを持ち、それを格納するポインター型(関数ポインター型)も存在します。関数ポインターの型は次のように構文が少々特殊なです。

```C++
return-type (*variable-name)(parameters...) = &function-name;
```

注意点として、ポインター変数の周りの括弧は必ず書かなければなりません。過去を忘れたり、 *の位置が変わると、「ポインターを返す関数」に意味が変わってしまいます。また戻り値のかたや引数の型は、代入しようとする関数のものと同じでなければなりません。
```C++
int sum(int x, int y);

// エラー　型が一致しない。
float (*pointer)(float, float) = &sum;

// エラー　引数のかたが一致しない
int (*pointer)(int, int, int) = &sum;
```

関数ポインターから関数を呼び出す場合には、間接参照演算子(*)を使う必要はありません。通常の関数と同じように変数に対して引数を与えると、そのポインター変数が示す先の関数が呼ばれます。

## 5.9.2 関数リファレンス
変数にポインター型があったように、関数にもポインター型がありました。それと同様に、変数に参照型があるように、関数にも参照型（**関数リファレンス**）があります。
関数リファレンスは参照型なので、変数の参照型と同じように後から参照先を変えることができません。
参照先を変えないのであれば直接その関数を呼び出してしまえばいいので、関数リファレンスは変数の3章ほどは使われません。
```C++
return-type (&variable-name)(parameters...) = function-name;
```

ポインターから参照に変わったときと同じく、*から&へと変わっていますが、戻り値の型や引数の型、数が一致しなければならないことは関数ポインターと同じ。

## 5.9.3 高階関数
関数ポインターや関数リファレンスを引数に持っていたり、戻り値として返す関数を**高階関数**といいます。高階関数は関数の動作をカスタマイズするために使われます。

関数ポインターや関数リファレンスも配列のときと同じく括弧があり扱いづらいので、別名を用意して使うのが良いでしょう。

```C++
using predicate = bool (int); // 関数型の別名

predicate* fptr = &is_odd; // 関数ポインター

predicate& fref = is_odd; // 関数リファレンス

using predicate_ptr = bool (*)(int); // 関数ポインター型の別名

predicate_ptr ptr = &is_less_than_5; // 関数ポインター

using predicate_ref = bool (&)(int); // 関数リファレンス型の別名

predicate_ref ref = is_less_than_5; // 関数リファレンス
```

特に関数へのポインターや参照を返す高階関数は、配列のポインターや参照を返す関数と同じく戻り値の方が非常に複雑になるため別名を使うべきです。
```C++
// int (float)型の関数へのポインターを返す関数
int (*function(int a, int b))(float) {}
```
# 6.10 代入演算子の詳細
演算子オーバーロードの中でも特別なものが**代入演算子**です。

## 6.10.1 コピー代入演算子とムーブ代入演算子
代入演算子にはコピー代入演算子とムーブ代入演算子の２通りがありますが、それぞれ役割が異なります。
コピー代入演算子はその名の通り、あるオブジェクトが持つメンバー変数などの値を他のオブジェクトにコピーするときに使われ、コピー元オブジェクトは変更されますせん（変更できません）。

一方ムーブ代入演算子は、ムーブコンストラクターと同じくオブジェクトが持つ特別なリソースなどの所有権を他のオブジェクトに明け渡すために使われます。

ほとんどの場合はデフォルトで定義される代入演算子で問題ないのですが、メンバー変数をそのままコピーしてしまっては困る場合があります。
例えば、コンストラクターで確保した動的メモリへのポインターをメンバー変数で持っていた場合、デフォルトで定義されるコピー代入演算子はポインターの値のみコピーして、ポインターが指す先のオブジェクトなどは複製しません。

先ほどのポインターの値をコピーしたオブジェクトと、コピー元のオブジェクトの2つをそのままデストラクターで解放してしまうと、その動的メモリを解放しようとするオブジェクトが2つあることになってしまい、2つ目のオブジェクトが破棄されるタイミングで多重解放が起きてしまいます。

そこで、代入演算子をオーバーロードしてコピー先で必要な動的メモリを新たに確保する処理を書くことで、多重解放の問題を解決することができます。


なお、コピー/ムーブコンストラクターのときと同じく、デストラクターやコピー/ムーブコンストラクター、代入演算子をユーザーが記述した場合には、それぞれのコンストラクター/代入演算子は自動的には定義されなくなってしまいます。必要に応じて自分で用意する必要があることに注意してください。

## 6.10.2 複合代入演算子
複合代入演算子となることができる通常の二項演算子と代入演算子をそれぞれ定義しても自動で複合代入演算子とはないらない。
そのためにこう演算子を定義する場合には、対応する複合代入演算子も定義することが一般的です。

一般に、二項演算子は元のオブジェクトには変更を加えず、計算した結果を新しいオブジェクトとして返します。一方、複合代入演算子の場合は代入まで行うので、constメンバー関数にはできず、また自分自身を参照で返します。
# 9.3 仮想関数とstaticメンバー

## 9.3.1 仮想関数テーブル
仮想関数はその仕組み上、テンプレート関数にすることができません。仮想関数を使って呼び出される派生クラスのメンバー関数は、オブジェクトの初期化のタイミングでその実態へのアドレスを**仮想関数テーブル**へと登録します。
そうすることで、基底クラスのポインターや参照で受け取ったとしても、仮想関数テーブルを経由してオーバーライドした派生クラスのメンバー関数を呼び出しています。

仮想関数テーブルをっsまで具体的な型が決まらないテンプレート関数は、仮想関数テーブルを用意することができず、仮想関数にすることができません。

## 9.3.2 クラステンプレートで仮想関数を扱う
関数テンプレートを仮想関数にできない一方、クラステンプレートは仮想関数を新たに作ったり、オーバーライドしたりすることができます。
あくまでクラスがテンプレートとなっているだけなので、そのクラスが実体化されれば（テンプレートパラメーターが決まれば）メンバー関数の型も決まるからです。

ただ、テンプレートパラメーターを使った仮想関数や仮想関数のオーバーライドには注意が必要です。もし、オーバーライドしたい基底クラスの仮想関数や、クラステンプレートから派生したクラスでのオーバーライドで型が異なってしまうと、エラーになったりオーバーライドが不完全になったりしてしまいます。

## 9.3.3 クラステンプレートでstaticメンバーを扱う
staticメンバーに関しては通常のクラスを大きく変わることはありません。ただ、staticメンバーであっても、テンプレート引数が確定しないことには実体化できないため、他のテンプレート引数が確定しないことには実体化ができないため、他のテンプレート同様の制限を受けます。

このとき注意しなければならないのは、同じクラステンプレートのstaticメンバー変数であっても、実態が異なれば別の変数として扱われるということです。
インスタンス間で値を共有しようとstaticメンバー変数を使ったとしても、もしテンプレート引数が異なると別の実態が作られるので値は正しく共有されません。
